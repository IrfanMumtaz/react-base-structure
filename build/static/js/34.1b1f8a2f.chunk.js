(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{857:function(e,a,t){"use strict";t.r(a);var n=t(98),r=t.n(n),c=t(99),i=t(20),l=t(21),s=t(23),o=t(22),d=t(24),m=t(0),u=t.n(m),p=t(95),f=t(25),k=t(94),_=t(96),E=t(97),v=(t(113),t(107)),h=t(109),g=h.object().shape({code:h.string().max(50,"Too long, max 50 characters").required("Required"),merchant_id:h.number().required("Required"),passenger_id:h.number().required("Required"),issuance:h.date().required("Required"),expiry:h.date().required("Required"),status:h.number().max(3).min(0).required("Required"),kin_name:h.string().max(50,"Too long, max 50 characters").required("Required"),kin_relation:h.string().max(50,"Too long, max 50 characters").required("Required"),kin_contact:h.string().max(50,"Too long, max 50 characters").required("Required"),pickup_add:h.string().max(190,"Pickup address too long.").required("Required"),dropoff_add:h.string().max(190,"Dropoff address too long.").required("Required")}),b=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(t=Object(s.a)(this,(e=Object(o.a)(a)).call.apply(e,[this].concat(l)))).state={auth:f.a.getState().authentication.Auth,formValues:{code:"",issuance:"",expiry:"",status:null,kin_name:"",kin_relation:"",kin_contact:"",merchant_id:null,passenger_id:null,pickup_add:"",dropoff_add:"",merchant:{id:null,name:""},passenger:{id:null,name:""},pickup:{full_address:""},dropoff:{full_address:""}},passengers:[],STATUS:new Array("Expired","Active","Refunded","Claimed"),alert:{display:!1,type:"success",message:""}},t.getPassengers=Object(c.a)(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.state.auth.token)}},fetch("".concat(p.a.base_url,"v1/passenger"),a).then(t.handleResponse).then(function(e){if(!0===e.success){var a=e.data.passengers;t.setState({passengers:a})}return e});case 2:case"end":return e.stop()}},e)})),t.getTicket=Object(c.a)(r.a.mark(function e(){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.props.match.params.id,t.state.formValues,n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.state.auth.token)}},fetch("".concat(p.a.base_url,"v1/ticket/").concat(a),n).then(t.handleResponse).then(function(e){if(!0===e.success){var a=e.data.ticket;a.merchant_id=a.merchant.id,a.passenger_id=a.passenger.id,a.pickup_add=a.pickup.full_address,a.dropoff_add=a.dropoff.full_address,t.setState({formValues:a})}return e});case 4:case"end":return e.stop()}},e)})),t.updateTicket=Object(c.a)(r.a.mark(function e(){var a,n,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.props.match.params.id,(n=t.state.formValues).pickup={full:n.pickup_add,latitude:54.2211,longitude:54.2211},n.dropoff={full:n.dropoff_add,latitude:54.2211,longitude:54.2211},console.log(n),c={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.state.auth.token)},body:JSON.stringify(n)},fetch("".concat(p.a.base_url,"v1/ticket/").concat(a),c).then(t.handleResponse).then(function(e){if(!0===e.success){var a={type:"success",message:e.message,display:!0};t.setState({alert:a})}else{var n={type:"danger",message:e.error.message,display:!0};t.setState({alert:n})}return e});case 7:case"end":return e.stop()}},e)})),t.handleSubmit=function(e){t.updateTicket()},t.handleChange=function(e){var a=t.state.formValues;a[e.target.name]=e.target.value,t.setState({formValues:a})},t.handleResetForm=function(){document.getElementById("form").reset()},t}return Object(d.a)(a,e),Object(l.a)(a,[{key:"componentWillMount",value:function(){this.getPassengers(),this.getTicket()}},{key:"handleResponse",value:function(e){return e.text().then(function(e){return e&&JSON.parse(e)})}},{key:"render",value:function(){var e=this,a=this.state,t=a.STATUS,n=a.formValues,r=a.passengers;return u.a.createElement(m.Fragment,null,u.a.createElement(k.a,null,"Ticket Update "),u.a.createElement(_.x,null,u.a.createElement(_.f,{md:"12"},u.a.createElement(_.d,null,u.a.createElement(_.e,null,u.a.createElement("div",{className:"px-3"},u.a.createElement(v.c,{enableReinitialize:!0,initialValues:n,validationSchema:g,onSubmit:function(a,t){var n=t.setSubmitting,r=t.resetForm;n(!0),e.setState({formValues:a}),e.handleSubmit(),n(!1),r()}},function(a){var c=a.values,i=a.isSubmitting,l=a.errors,s=a.touched,o=a.handleChange;return u.a.createElement(v.b,{id:"form"},u.a.createElement("div",{className:"form-body"},u.a.createElement("h4",{className:"form-section"},u.a.createElement(E.Home,{size:20,color:"#212529"})," Ticket Info"),u.a.createElement(_.x,null,u.a.createElement(_.f,{md:"6"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"name"},"Ticket Code"),u.a.createElement(v.a,{name:"code",id:"code",value:c.code,disabled:!0,className:"form-control ".concat(l.name&&s.name&&"is-invalid")}),l.code&&s.code?u.a.createElement("div",{className:"invalid-feedback"},l.code):null)),u.a.createElement(_.f,{md:"6"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"passenger_id"},"Passenger"),u.a.createElement("select",{onChange:o,id:"passenger_id",name:"passenger_id",className:"form-control ".concat(l.passenger_id&&s.passenger_id&&"is-invalid")},u.a.createElement("option",{value:"0",defaultValue:"",disabled:""},"Select Passenger"),r.map(function(e){return u.a.createElement("option",{value:e.id,key:e.id,selected:e.id===n.passenger.id},"".concat(e.name," (").concat(e.cnic,")"))})),l.passenger_id&&s.passenger_id?u.a.createElement("div",{className:"invalid-feedback"},l.passenger_id):null))),u.a.createElement(_.x,null,u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"issuance"},"Issuance"),u.a.createElement(_.n,{id:"issuance",type:"date",value:n.issuance,name:"issuance",className:"form-control ".concat(l.issuance&&s.issuance&&"is-invalid")}),l.issuance&&s.issuance?u.a.createElement("div",{className:"invalid-feedback"},l.issuance):null)),u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"expiry"},"Expiry"),u.a.createElement(_.n,{name:"expiry",type:"date",value:n.expiry,id:"expiry",className:"form-control ".concat(l.expiry&&s.expiry&&"is-invalid")}),l.expiry&&s.expiry?u.a.createElement("div",{className:"invalid-feedback"},l.expiry):null)),u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"status"},"Status"),u.a.createElement("select",{onChange:o,id:"status",name:"status",className:"form-control ".concat(l.status&&s.status&&"is-invalid")},u.a.createElement("option",{value:"-1",defaultValue:"",disabled:""},"Select Status"),t.map(function(e,a){return u.a.createElement("option",{value:a,key:a,selected:a===n.status},"".concat(e))})),l.passenger_id&&s.passenger_id?u.a.createElement("div",{className:"invalid-feedback"},l.passenger_id):null))),u.a.createElement(_.x,null,u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"kin_name"},"Kin Name"),u.a.createElement(_.n,{id:"kin_name",value:n.kin_name,name:"kin_name",className:"form-control  ".concat(l.kin_name&&s.kin_name&&"is-invalid")}),l.kin_name&&s.kin_name?u.a.createElement("div",{className:"invalid-feedback"},l.kin_name):null)),u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"kin_relation"},"Kin Relation"),u.a.createElement(_.n,{name:"kin_relation",value:n.kin_relation,id:"kin_relation",className:"form-control  ".concat(l.kin_relation&&s.kin_relation&&"is-invalid")}),l.kin_relation&&s.kin_relation?u.a.createElement("div",{className:"invalid-feedback"},l.kin_relation):null)),u.a.createElement(_.f,{md:"4"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"kin_contact"},"Kin Contact"),u.a.createElement(_.n,{name:"kin_contact",value:n.kin_contact,id:"kin_contact",className:"form-control  ".concat(l.kin_contact&&s.kin_contact&&"is-invalid")}),l.kin_contact&&s.kin_contact?u.a.createElement("div",{className:"invalid-feedback"},l.kin_contact):null))),u.a.createElement(_.x,null,u.a.createElement(_.f,{md:"6"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"pickup_add"},"Pickup"),u.a.createElement(_.n,{id:"pickup_add",value:n.pickup_add,name:"pickup_add",className:"form-control  ".concat(l.pickup_add&&s.pickup_add&&"is-invalid")}),l.pickup_add&&s.pickup_add?u.a.createElement("div",{className:"invalid-feedback"},l.pickup_add):null)),u.a.createElement(_.f,{md:"6"},u.a.createElement(_.m,null,u.a.createElement(_.o,{for:"dropoff_add"},"Dropoff"),u.a.createElement(_.n,{name:"dropoff_add",value:n.dropoff_add,id:"dropoff_add",className:"form-control  ".concat(l.dropoff_add&&s.dropoff_add&&"is-invalid")}),l.dropoff_add&&s.dropoff_add?u.a.createElement("div",{className:"invalid-feedback"},l.dropoff_add):null)))),u.a.createElement("div",{className:"form-actions"},u.a.createElement(_.c,{color:"primary",type:"submit",disabled:i},u.a.createElement(E.CheckSquare,{size:16,color:"#FFF"})," Save"),e.state.alert.display&&u.a.createElement(_.a,{color:e.state.alert.type},e.state.alert.message)))})))))))}}]),a}(m.Component);a.default=b},94:function(e,a,t){"use strict";var n=t(0),r=t.n(n);a.a=function(e){var a=e.className;return r.a.createElement("div",{className:"content-header".concat(void 0===a?"":" ".concat(a))},e.children)}},95:function(e,a,t){"use strict";a.a={base_url:"http://api.ticketmanagement.local/"}}}]);
//# sourceMappingURL=34.1b1f8a2f.chunk.js.map